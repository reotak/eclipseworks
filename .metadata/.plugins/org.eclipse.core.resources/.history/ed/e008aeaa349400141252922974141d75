package gui;

import java.awt.BorderLayout;
import java.awt.Dimension;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JComboBox;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JPanel;
import javax.swing.JScrollPane;
import javax.swing.JTable;
import javax.swing.JTextField;
import javax.swing.table.DefaultTableModel;

class SetArgumentsWindow extends JFrame {
	private final java.lang.reflect.Type[] argTypes;
	private final Object[] args;
	private final JTable settingArgsTable;
	private final InstanceViewer instanceViewer;
	private final JTable instanceTable;
	private final JTextField primaryTextField;
	private final JComboBox<String> primaryComboBox;

	public SetArgumentsWindow(java.lang.reflect.Type[] argTypes, CatchArguments to, InstanceViewer instanceViewer) {
		this.setTitle("引数の設定");
		this.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);

		this.argTypes = argTypes;
		this.instanceViewer = instanceViewer;
		this.setBounds(10, 10, 500, 800);

		// argsを生成
		this.args = new Object[argTypes.length];

		// 設定済みの引数を表示するテーブル
		JPanel settingArgsPanel = new JPanel();
		settingArgsPanel.add(new JLabel("設定済みの引数"), BorderLayout.NORTH);
		settingArgsTable = new JTable(new DefaultTableModel(new String[] {"型", "値"}, 0) {
			public boolean isCellEditable(int row, int column) {
				return false;
			}
		});

		for (int i = 0; i < argTypes.length; i++) {
			((DefaultTableModel)settingArgsTable.getModel()).addRow(
				new String[] { intepret.Util.typeToString(argTypes[i]), "未設定" });
		}
		JScrollPane sp1 = new JScrollPane(settingArgsTable);
		sp1.setPreferredSize(new Dimension(450, 200));
		settingArgsTable.doLayout();
		settingArgsPanel.add(sp1, BorderLayout.CENTER);
		getContentPane().add(settingArgsPanel, BorderLayout.NORTH);


		// InstanceTableを表示
		JPanel instanceTablePanel = new JPanel();
		instanceTablePanel.add(new JLabel("既存のインスタンスに設定:"), BorderLayout.NORTH);
		instanceTable = instanceViewer.getInstanceTable();
		JScrollPane sp2 = new JScrollPane(instanceTable);
		sp2.setPreferredSize(new Dimension(450, 450));
		instanceTable.doLayout();
		instanceTablePanel.add(sp2);

		// InstanceTable の反映ボタン
		JButton selectedInstanceButton = new JButton("既存のオブジェクトを値に設定");
		selectedInstanceButton.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				addArgFromSelectedInstanceTable();
			}
		});
		instanceTablePanel.add(selectedInstanceButton);
		getContentPane().add(instanceTablePanel, BorderLayout.CENTER);

		// プライマリな値に設定するためのパネル
		JPanel primaryPanel = new JPanel();
		instanceTablePanel.add(new JLabel("プライマリな型から設定:"), BorderLayout.NORTH);

		primaryComboBox = new JComboBox<String>(intepret.Util.getPrimaryTypes());
		primaryPanel.add(primaryComboBox, BorderLayout.CENTER);

		JButton setButton = new JButton("この値に変更");
		setButton.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent e) {
				trySetPrimaryValue();
			}
		});
		primaryPanel.add(setButton, BorderLayout.SOUTH);

		primaryTextField = new JTextField();
		primaryTextField.setColumns(15);
		primaryPanel.add(primaryTextField, BorderLayout.SOUTH);

		getContentPane().add(primaryPanel, BorderLayout.SOUTH);

	}

	private void addArgFromSelectedInstanceTable() {
		// TODO 自動生成されたメソッド・スタブ

	}
}
