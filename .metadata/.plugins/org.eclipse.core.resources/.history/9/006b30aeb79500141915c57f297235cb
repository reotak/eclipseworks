package ex16_10;

import java.util.Calendar;
import java.util.List;

public class Game {
	public static void main(String[] args) {
		String name; // クラス名
		while ((name = getNextPlayer()) != null) {
			try {
				PlayerLoader loader = new PlayerLoader();
				Class<? extends Player> classOf = loader.loadClass(name).asSubclass(Player.class);
				Player player = classOf.newInstance();

				Game game = new Game();
				player.play(game);
				game.reportScore(name);
			} catch (Exception e) {
				reportException(name, e);
			}
		}
	}

	private static String[] players = new String[] {"ex16_10.SamplePlayer", "ex16_10.SamplePlayer" };
	private static int nowPlayer = 0;


	private static String getNextPlayer() {
		if (nowPlayer < players.length) {
			return players[nowPlayer++];
		} else {
			return null;
		}
	}

	// ------ ゲームのルール ---------
	// 1. プレイヤーがstartを呼び出すとゲームが始まる
	// 2. プレイヤーはゲームに丁度1701個の単語を登録したときに、iAmWinnerを呼び出せば勝利条件を満たし、勝利できる
	// 3. 一つでも同じ単語が登録されている場合は、勝利条件を満たさない
	// 4. 勝利条件を満たしていないときに、iAmWinnerを呼び出すとプレイヤーの負けとなる。
	// 5. スコアはプレイヤーが負けた場合0点、勝った場合は、(200(ms) - 勝利まで掛かった時間(ms))点とする
	// 6. ゲームは同時に話かけられることにより、単語を聞き漏らすことがある。それはプレイヤーの責任となる。
	// 7. iAmWinnerが呼び出されることでゲームは終了する。（プレイヤーはplayを終了しなければならない）
	// ------ 以下、ゲームの実装 -----
	private Calendar startTime;
	private Calendar clearTime;

	private boolean isPlayerWin;
	private List<String> words;

	public void start() {
		startTime = Calendar.getInstance();
	}

	public String iAmWinner() {
		clearTime = Calendar.getInstance();

		if (words.size() == 1701) {
			isPlayerWin = true;
		}
	}

	private void reportScore(String name) {
		System.out.println("reoprt");
	}

	private static void reportException(String name, Exception e) {
		System.out.println("Error");
		System.out.println(" Player :" + name);
		System.out.println(" Exception :" + e);
	}
}
