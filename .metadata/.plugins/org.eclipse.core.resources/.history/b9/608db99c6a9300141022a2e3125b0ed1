package intepret;

import java.lang.reflect.InvocationTargetException;
import java.util.Dictionary;
import java.util.Hashtable;
import java.util.List;

class InstanceTable {
	protected int lastId = 0;
	private Dictionary<String, Instance> table = new Hashtable<String, Instance>();

	public void addNewInstance(Constructor con, List<Object> args) throws InstantiationException, IllegalAccessException, IllegalArgumentException, InvocationTargetException {
		try {
			String id = createNewId();
			table.put(id, new Instance(id, con, args));
		} catch (Exception e) {
			lastId--;
			throw e;
		}
	}

	public String createNewId() {
		if (lastId >= 999) {
			throw new RuntimeException("これ以上オブジェクトを生成できません。");
		}
		return String.format("#%04d", lastId++);
	}
}
